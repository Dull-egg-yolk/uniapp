(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/components/noLoginPage"],{321:function(e,n,t){"use strict";t.r(n);var r=t(322),o=t(324);for(var a in o)["default"].indexOf(a)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(a);t(326);var s,i=t(32),u=Object(i["default"])(o["default"],r["render"],r["staticRenderFns"],!1,null,"66183739",null,!1,r["components"],s);u.options.__file="pages/user/components/noLoginPage.vue",n["default"]=u.exports},322:function(e,n,t){"use strict";t.r(n);var r=t(323);t.d(n,"render",(function(){return r["render"]})),t.d(n,"staticRenderFns",(function(){return r["staticRenderFns"]})),t.d(n,"recyclableRender",(function(){return r["recyclableRender"]})),t.d(n,"components",(function(){return r["components"]}))},323:function(e,n,t){"use strict";var r;t.r(n),t.d(n,"render",(function(){return o})),t.d(n,"staticRenderFns",(function(){return s})),t.d(n,"recyclableRender",(function(){return a})),t.d(n,"components",(function(){return r}));var o=function(){var e=this,n=e.$createElement;e._self._c},a=!1,s=[];o._withStripped=!0},324:function(e,n,t){"use strict";t.r(n);var r=t(325),o=t.n(r);for(var a in r)["default"].indexOf(a)<0&&function(e){t.d(n,e,(function(){return r[e]}))}(a);n["default"]=o.a},325:function(e,n,t){"use strict";(function(e,r){var o=t(4);Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=o(t(51)),s=o(t(11)),i=o(t(5)),u=o(t(53)),c=t(54);function f(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?f(Object(t),!0).forEach((function(n){(0,s.default)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var d=(0,s.default)({components:{},data:function(){return{user_name:"",user_id:"",personalInvitePage:"",configList:[]}},mounted:function(){this.appConfig()},onLoad:function(){var n=e.getStorageSync("user_info");this.user_name=n.data.user.user_name,this.user_id=n.data.user.username},methods:{appConfig:function(){var n=this;return(0,u.default)(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,c.appConfig)().then((function(t){if(t.ErrorMsg)e.showToast({title:t.ErrorMsg,icon:"none"});else{var r=t.Data;r.forEach((function(e){"PersonalInvitePage"===e.Key&&(n.personalInvitePage=e.Value)})),e.setStorageSync("user_config",t.Data)}}));case 2:case"end":return t.stop()}}),t)})))()},gotoWebsite:function(){r.navigateTo({url:"/subpackageB/webview/webview?url="+encodeURIComponent(this.personalInvitePage)})},getWxUserInfo:function(){var n=this;return(0,u.default)(a.default.mark((function t(){var r,o,s,u,f,l;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.showLoading({title:"登录中..."}),t.next=4,n.getUserProfile();case 4:return r=t.sent,console.log(r,"userInfo"),e.setStorageSync("userInfo",r),t.next=9,e.login({provider:"weixin"});case 9:return o=t.sent,s=(0,i.default)(o,2),s[0],u=s[1],console.log(u,"loginRes"),f={Name:r.nickName,WxCode:u.code,Avatar:r.avatarUrl,InvitedByHotelID:0},t.next=17,(0,c.userLogin)(f);case 17:l=t.sent,l.ErrorMsg?e.showToast({title:l.ErrorMsg,icon:"none"}):(e.hideLoading(),e.setStorageSync("token",l.Data.Token),e.setStorageSync("user_info",l.Data),e.showToast({title:"登录成功",icon:"none"}),setTimeout((function(){0===l.Data.Hotel.ID?e.navigateTo({url:"/subpackageA/form/form"}):e.switchTab({url:"/pages/home/home"})}),300)),t.next=24;break;case 21:t.prev=21,t.t0=t["catch"](0),console.error("登录失败:",t.t0);case 24:case"end":return t.stop()}}),t,null,[[0,21]])})))()},getUserProfile:function(){return new Promise((function(n,t){e.getUserProfile({desc:"用于完善会员信息",success:function(e){return n(e.userInfo)},fail:function(e){return t(e)}})}))},onGetPhoneNumber:function(n){var t=this;return(0,u.default)(a.default.mark((function r(){var o,s,u,c,f,d;return a.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(console.log("999"),"getPhoneNumber:ok"===n.detail.errMsg){r.next=4;break}return e.showToast({title:"用户拒绝了授权",icon:"none"}),r.abrupt("return");case 4:return e.showLoading({title:"登录中...",mask:!0}),r.prev=5,console.log(1111),r.next=9,t.getUserProfile();case 9:return o=r.sent,console.log(o,"userInfo"),console.log(12222),r.next=14,e.login({provider:"weixin"});case 14:if(s=r.sent,u=(0,i.default)(s,2),c=u[0],f=u[1],console.log(1333),!c){r.next=21;break}throw new Error("微信登录失败");case 21:if(console.log(f,"loginRes"),!requestErr&&200===res.data.code){r.next=24;break}throw new Error((null===(d=res.data)||void 0===d?void 0:d.msg)||"解密手机号失败");case 24:t.hasLogin=!0,t.userInfo=l(l({},res.data.data),{},{phoneNumber:res.data.data.phoneNumber.replace(/^(\d{3})\d{4}(\d{4})$/,"$1****$2")}),e.setStorageSync("token",res.data.token),e.showToast({title:"登录成功"}),r.next=33;break;case 30:r.prev=30,r.t0=r["catch"](5),e.showToast({title:r.t0.message,icon:"none"});case 33:return r.prev=33,e.hideLoading(),r.finish(33);case 36:case"end":return r.stop()}}),r,null,[[5,30,33,36]])})))()}}},"onLoad",(function(){e.getStorageSync("token")&&(this.hasLogin=!0,this.userInfo=e.getStorageSync("userInfo")||{})}));n.default=d}).call(this,t(2)["default"],t(1)["default"])},326:function(e,n,t){"use strict";t.r(n);var r=t(327),o=t.n(r);for(var a in r)["default"].indexOf(a)<0&&function(e){t.d(n,e,(function(){return r[e]}))}(a);n["default"]=o.a},327:function(e,n,t){}}]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/pages/user/components/noLoginPage.js.map
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'pages/user/components/noLoginPage-create-component',
    {
        'pages/user/components/noLoginPage-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('2')['createComponent'](__webpack_require__(321))
        })
    },
    [['pages/user/components/noLoginPage-create-component']]
]);
