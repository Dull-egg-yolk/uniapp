require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["subpackageA/enter/index"],{84:function(t,e,n){"use strict";(function(t,e){var r=n(4);n(26);r(n(25));var a=r(n(85));t.__webpack_require_UNI_MP_PLUGIN__=n,e(a.default)}).call(this,n(1)["default"],n(2)["createPage"])},85:function(t,e,n){"use strict";n.r(e);var r=n(86),a=n(88);for(var o in a)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(o);n(90);var i,s=n(32),c=Object(s["default"])(a["default"],r["render"],r["staticRenderFns"],!1,null,"789c2329",null,!1,r["components"],i);c.options.__file="subpackageA/enter/index.vue",e["default"]=c.exports},86:function(t,e,n){"use strict";n.r(e);var r=n(87);n.d(e,"render",(function(){return r["render"]})),n.d(e,"staticRenderFns",(function(){return r["staticRenderFns"]})),n.d(e,"recyclableRender",(function(){return r["recyclableRender"]})),n.d(e,"components",(function(){return r["components"]}))},87:function(t,e,n){"use strict";var r;n.r(e),n.d(e,"render",(function(){return a})),n.d(e,"staticRenderFns",(function(){return i})),n.d(e,"recyclableRender",(function(){return o})),n.d(e,"components",(function(){return r}));var a=function(){var t=this,e=t.$createElement;t._self._c},o=!1,i=[];a._withStripped=!0},88:function(t,e,n){"use strict";n.r(e);var r=n(89),a=n.n(r);for(var o in r)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(o);e["default"]=a.a},89:function(t,e,n){"use strict";(function(t,r){var a=n(4);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(n(51)),i=a(n(53)),s=n(72),c=n(73),u=n(54),f={data:function(){return{imageUrl:"",imagePath:"",uploadToken:"",classList:[],selectedClass:"请选择",form:{Name:"",Uint:"",Format:"",Price:"",ClassID:"",Suppliers:"",MinStock:"",MaxStock:"",Image:"",Note:""},HotelID:0,qiniuDomain:"https://staticweb.jiudianhui.com.cn",categories:["默认分类","分类1","分类2","分类3"]}},methods:{getHotelClassList:function(){var t=this;return(0,i.default)(o.default.mark((function e(){var n;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,c.getHotelClass)();case 2:n=e.sent,t.classList=n.Data;case 4:case"end":return e.stop()}}),e)})))()},getUserConfig:function(){var e=this;return(0,i.default)(o.default.mark((function n(){return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,u.getUserConfig)().then((function(n){n.ErrorMsg?t.showToast({title:n.ErrorMsg,icon:"none"}):e.uploadToken=n.Data.CdnT}));case 2:n.sent;case 3:case"end":return n.stop()}}),n)})))()},chooseImage:function(){var e=this;t.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(){var t=(0,i.default)(o.default.mark((function t(n){var a;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.imagePath=n.tempFilePaths[0],t.next=3,new Promise((function(t){r.compressImage({src:e.imagePath,quality:80,success:t,fail:function(n){console.log("压缩失败",n),t({tempFilePath:e.imagePath})}})}));case 3:a=t.sent,setTimeout((function(){e.uploadImage(a.tempFilePath,e.uploadToken)}),100);case 5:case"end":return t.stop()}}),t)})));function n(e){return t.apply(this,arguments)}return n}()})},uploadImage:function(e,n){var r=this;return new Promise((function(a,o){var i="ims/dev/goods/".concat(r.HotelID,"/").concat(Date.now(),".").concat(e.split(".").pop());t.uploadFile({url:"https://up-z1.qiniup.com",filePath:e,name:"file",header:{"Content-Type":"multipart/form-data"},formData:{token:n,key:i},success:function(t){if(200===t.statusCode){var e=JSON.parse(t.data);r.form.Image="".concat(r.qiniuDomain,"/").concat(e.key),r.imageUrl="".concat(r.qiniuDomain,"/").concat(e.key),console.log(r.form.Image,"0"),a(e)}else o(new Error("上传失败"))},fail:function(t){o(t)}})}))},onCategoryChange:function(t){this.form.category=this.categories[t.detail.value]},submitForm:(0,s.throttle)((0,i.default)(o.default.mark((function e(){var n=this;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.form.Price=Number(this.form.Price),this.form.MinStock=Number(this.form.MinStock),this.form.MaxStock=Number(this.form.MaxStock),this.form.ClassID=this.classList.find((function(t){return t.Name===n.selectedClass})).ID,this.form.Name){e.next=7;break}return t.showToast({title:"请填写物品名称",icon:"none"}),e.abrupt("return");case 7:if(this.form.Uint){e.next=10;break}return t.showToast({title:"请填写单位",icon:"none"}),e.abrupt("return");case 10:if(this.form.Format){e.next=13;break}return t.showToast({title:"请填写物品规格",icon:"none"}),e.abrupt("return");case 13:if(this.form.Price){e.next=16;break}return t.showToast({title:"请填写物品价格",icon:"none"}),e.abrupt("return");case 16:if(this.form.ClassID){e.next=19;break}return t.showToast({title:"请选择物品分类",icon:"none"}),e.abrupt("return");case 19:if(this.form.Suppliers){e.next=22;break}return t.showToast({title:"请填写物品供货商",icon:"none"}),e.abrupt("return");case 22:if(this.form.MinStock){e.next=25;break}return t.showToast({title:"请填写物品最小库存",icon:"none"}),e.abrupt("return");case 25:if(this.form.MaxStock){e.next=28;break}return t.showToast({title:"请填写物品最大库存",icon:"none"}),e.abrupt("return");case 28:if(this.form.Image){e.next=31;break}return t.showToast({title:"请上传物品图片",icon:"none"}),e.abrupt("return");case 31:return e.next=33,(0,c.addGoodsItme)(this.form).then((function(e){e.ErrorMsg?t.showToast({title:e.ErrorMsg,icon:"none"}):(t.showToast({title:"提交成功",icon:"success"}),n.form={Name:"",Uint:"",Format:"",Price:"",ClassID:"",Suppliers:"",MinStock:"",MaxStock:"",Image:"",Note:""},n.imageUrl="")}));case 33:case"end":return e.stop()}}),e,this)}))),500),onClassChange:function(t){this.selectedClass=this.classList[t.detail.value].Name}},mounted:function(){this.getUserConfig(),this.getHotelClassList(),this.HotelID=t.getStorageSync("user_info").Hotel.ID}};e.default=f}).call(this,n(2)["default"],n(1)["default"])},90:function(t,e,n){"use strict";n.r(e);var r=n(91),a=n.n(r);for(var o in r)["default"].indexOf(o)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(o);e["default"]=a.a},91:function(t,e,n){}},[[84,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/subpackageA/enter/index.js.map