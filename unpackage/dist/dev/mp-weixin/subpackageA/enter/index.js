require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["subpackageA/enter/index"],{85:function(e,t,n){"use strict";(function(e,t){var o=n(4);n(26);o(n(25));var r=o(n(86));e.__webpack_require_UNI_MP_PLUGIN__=n,t(r.default)}).call(this,n(1)["default"],n(2)["createPage"])},86:function(e,t,n){"use strict";n.r(t);var o=n(87),r=n(89);for(var a in r)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(a);n(91);var s,i=n(32),c=Object(i["default"])(r["default"],o["render"],o["staticRenderFns"],!1,null,"789c2329",null,!1,o["components"],s);c.options.__file="subpackageA/enter/index.vue",t["default"]=c.exports},87:function(e,t,n){"use strict";n.r(t);var o=n(88);n.d(t,"render",(function(){return o["render"]})),n.d(t,"staticRenderFns",(function(){return o["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return o["recyclableRender"]})),n.d(t,"components",(function(){return o["components"]}))},88:function(e,t,n){"use strict";var o;n.r(t),n.d(t,"render",(function(){return r})),n.d(t,"staticRenderFns",(function(){return s})),n.d(t,"recyclableRender",(function(){return a})),n.d(t,"components",(function(){return o}));try{o={imgPopup:function(){return Promise.all([n.e("common/vendor"),n.e("components/img-popup/img-popup")]).then(n.bind(null,344))}}}catch(i){if(-1===i.message.indexOf("Cannot find module")||-1===i.message.indexOf(".vue"))throw i;console.error(i.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var r=function(){var e=this,t=e.$createElement;e._self._c},a=!1,s=[];r._withStripped=!0},89:function(e,t,n){"use strict";n.r(t);var o=n(90),r=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=r.a},90:function(e,t,n){"use strict";(function(e,o){var r=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(43)),s=r(n(45)),i=n(73),c=n(74),u=n(46),l=function(){Promise.all([n.e("common/vendor"),n.e("components/img-popup/img-popup")]).then(function(){return resolve(n(344))}.bind(null,n)).catch(n.oe)},f={components:{imgPopup:l},data:function(){return{imgContent:"",scanUrl:"",title:"",DefaultWarehouseID:0,GoodsID:0,goodList:{},imageUrl:"",imagePath:"",uploadToken:"",classList:[],selectedClass:"请选择",isUpdate:!1,form:{Name:"",Uint:"",Format:"",Price:"",ClassID:"",Suppliers:"",MinStock:0,MaxStock:9999,Image:"",Note:""},HotelID:0,qiniuDomain:"https://staticweb.jiudianhui.com.cn",categories:["默认分类","分类1","分类2","分类3"]}},methods:{getHotelClassList:function(){var e=this;return(0,s.default)(a.default.mark((function t(){var n;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,c.getHotelClass)();case 2:n=t.sent,e.classList=n.Data;case 4:case"end":return t.stop()}}),t)})))()},getUserConfig:function(){var t=this;return(0,s.default)(a.default.mark((function n(){return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,u.getUserConfig)().then((function(n){n.ErrorMsg?e.showToast({title:n.ErrorMsg,icon:"none"}):t.uploadToken=n.Data.CdnT}));case 2:n.sent;case 3:case"end":return n.stop()}}),n)})))()},chooseImage:function(){var t=this;e.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(){var e=(0,s.default)(a.default.mark((function e(n){var r;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.imagePath=n.tempFilePaths[0],console.log(t.imagePath,"1"),e.next=4,new Promise((function(e){o.compressImage({src:t.imagePath,quality:80,success:e,fail:function(n){console.log("压缩失败",n),e({tempFilePath:t.imagePath})}})}));case 4:r=e.sent,setTimeout((function(){t.uploadImage(r.tempFilePath,t.uploadToken)}),100);case 6:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}()})},uploadImage:function(t,n){var o=this;return new Promise((function(r,a){var s="ims/dev/goods/".concat(o.HotelID,"/").concat(Date.now(),".").concat(t.split(".").pop());e.uploadFile({url:"https://up-z1.qiniup.com",filePath:t,name:"file",header:{"Content-Type":"multipart/form-data"},formData:{token:n,key:s},success:function(e){if(200===e.statusCode){var t=JSON.parse(e.data);o.form.Image="".concat(o.qiniuDomain,"/").concat(t.key),o.imageUrl="".concat(o.qiniuDomain,"/").concat(t.key),console.log(o.form.Image,"0"),r(t)}else a(new Error("上传失败"))},fail:function(e){a(e)}})}))},submitForm:(0,i.throttle)((0,s.default)(a.default.mark((function t(){var n=this;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.form.Price=Number(this.form.Price),this.form.ClassID=this.classList.find((function(e){return e.Name===n.selectedClass})).ID,this.form.Name){t.next=5;break}return e.showToast({title:"请填写物品名称",icon:"none"}),t.abrupt("return");case 5:if(this.form.Uint){t.next=8;break}return e.showToast({title:"请填写单位",icon:"none"}),t.abrupt("return");case 8:if(this.form.Format){t.next=11;break}return e.showToast({title:"请填写物品规格",icon:"none"}),t.abrupt("return");case 11:if(this.form.Price){t.next=14;break}return e.showToast({title:"请填写物品价格",icon:"none"}),t.abrupt("return");case 14:if(this.form.ClassID){t.next=17;break}return e.showToast({title:"请选择物品分类",icon:"none"}),t.abrupt("return");case 17:if(this.form.Suppliers){t.next=20;break}return e.showToast({title:"请填写物品供货商",icon:"none"}),t.abrupt("return");case 20:if("number"===typeof this.form.MinStock){t.next=23;break}return e.showToast({title:"请填写物品最小库存",icon:"none"}),t.abrupt("return");case 23:if("number"===typeof this.form.MaxStock){t.next=26;break}return e.showToast({title:"请填写物品最大库存",icon:"none"}),t.abrupt("return");case 26:if(this.form.Image){t.next=29;break}return e.showToast({title:"请上传物品图片",icon:"none"}),t.abrupt("return");case 29:if(console.log(this.isUpdate,"1"),!this.isUpdate){t.next=35;break}return t.next=33,(0,c.updateGoodsItme)(this.form).then((function(t){t.ErrorMsg?e.showToast({title:t.ErrorMsg,icon:"none"}):(n.DefaultWarehouseID=t.Data.DefaultWarehouseID,n.GoodsID=t.Data.ID,n.goodList=t.Data,e.showToast({title:"提交成功",icon:"success"}),n.form={Name:"",Uint:"",Format:"",Price:"",ClassID:"",Suppliers:"",MinStock:"",MaxStock:"",Image:"",Note:""},n.imageUrl="",n.getScan())}));case 33:t.next=37;break;case 35:return t.next=37,(0,c.addGoodsItme)(this.form).then((function(t){t.ErrorMsg?e.showToast({title:t.ErrorMsg,icon:"none"}):(n.DefaultWarehouseID=t.Data.DefaultWarehouseID,n.GoodsID=t.Data.ID,n.goodList=t.Data,e.showToast({title:"提交成功",icon:"success"}),n.form={Name:"",Uint:"",Format:"",Price:"",ClassID:"",Suppliers:"",MinStock:"",MaxStock:"",Image:"",Note:""},n.imageUrl="",n.getScan())}));case 37:case"end":return t.stop()}}),t,this)}))),500),onClassChange:function(e){this.selectedClass=this.classList[e.detail.value].Name},getScan:function(){var t=this;return(0,s.default)(a.default.mark((function n(){var o,r;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o={WarehouseID:t.DefaultWarehouseID,GoodsID:t.GoodsID},n.next=3,(0,c.getQrcode)(o);case 3:r=n.sent,r.ErrorMsg?e.showToast({title:r.ErrorMsg,icon:"none"}):(t.scanUrl=r.Data,t.imgContent=t.goodList.Name+" "+t.goodList.Format+"/"+t.goodList.Uint,t.$refs.imagePopup.open());case 5:case"end":return n.stop()}}),n)})))()}},mounted:function(){this.getUserConfig(),this.getHotelClassList(),this.HotelID=e.getStorageSync("user_info").Hotel.ID},onLoad:function(e){var t=this;return(0,s.default)(a.default.mark((function n(){var o;return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.getHotelClassList();case 2:o=JSON.parse(decodeURIComponent(e.form)),o&&(t.isUpdate=!0,console.log(o,"options.form"),t.form=o,t.imageUrl=o.Image,t.selectedClass=t.classList.find((function(e){return e.ID===o.ClassID})).Name);case 4:case"end":return n.stop()}}),n)})))()}};t.default=f}).call(this,n(2)["default"],n(1)["default"])},91:function(e,t,n){"use strict";n.r(t);var o=n(92),r=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=r.a},92:function(e,t,n){}},[[85,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/subpackageA/enter/index.js.map