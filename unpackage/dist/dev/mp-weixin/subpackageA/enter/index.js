require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["subpackageA/enter/index"],{84:function(e,t,n){"use strict";(function(e,t){var r=n(4);n(26);r(n(25));var a=r(n(85));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n(1)["default"],n(2)["createPage"])},85:function(e,t,n){"use strict";n.r(t);var r=n(86),a=n(88);for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);n(90);var i,s=n(32),c=Object(s["default"])(a["default"],r["render"],r["staticRenderFns"],!1,null,"789c2329",null,!1,r["components"],i);c.options.__file="subpackageA/enter/index.vue",t["default"]=c.exports},86:function(e,t,n){"use strict";n.r(t);var r=n(87);n.d(t,"render",(function(){return r["render"]})),n.d(t,"staticRenderFns",(function(){return r["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return r["recyclableRender"]})),n.d(t,"components",(function(){return r["components"]}))},87:function(e,t,n){"use strict";var r;n.r(t),n.d(t,"render",(function(){return a})),n.d(t,"staticRenderFns",(function(){return i})),n.d(t,"recyclableRender",(function(){return o})),n.d(t,"components",(function(){return r}));var a=function(){var e=this,t=e.$createElement;e._self._c},o=!1,i=[];a._withStripped=!0},88:function(e,t,n){"use strict";n.r(t);var r=n(89),a=n.n(r);for(var o in r)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=a.a},89:function(e,t,n){"use strict";(function(e,r){var a=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n(51)),i=a(n(53)),s=n(72),c=n(73),u=n(54),l={data:function(){return{imageUrl:"",imagePath:"",uploadToken:"",classList:[],selectedClass:"请选择",form:{Name:"",Uint:"",Format:"",Price:"",ClassID:"",Suppliers:"",MinStock:"",MaxStock:"",Image:"",Note:""},HotelID:0,qiniuDomain:"https://staticweb.jiudianhui.com.cn",categories:["默认分类","分类1","分类2","分类3"]}},methods:{getHotelClassList:function(){var e=this;return(0,i.default)(o.default.mark((function t(){var n;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,c.getHotelClass)();case 2:n=t.sent,e.classList=n.Data;case 4:case"end":return t.stop()}}),t)})))()},getUserConfig:function(){var t=this;return(0,i.default)(o.default.mark((function n(){return o.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,u.getUserConfig)().then((function(n){n.ErrorMsg?e.showToast({title:n.ErrorMsg,icon:"none"}):t.uploadToken=n.Data.CdnT}));case 2:n.sent;case 3:case"end":return n.stop()}}),n)})))()},chooseImage:function(){var t=this;e.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(){var e=(0,i.default)(o.default.mark((function e(n){var a;return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.imagePath=n.tempFilePaths[0],e.next=3,new Promise((function(e){r.compressImage({src:t.imagePath,quality:80,success:e,fail:function(n){console.log("压缩失败",n),e({tempFilePath:t.imagePath})}})}));case 3:a=e.sent,setTimeout((function(){t.uploadImage(a.tempFilePath,t.uploadToken)}),100);case 5:case"end":return e.stop()}}),e)})));function n(t){return e.apply(this,arguments)}return n}()})},uploadImage:function(t,n){var r=this;return new Promise((function(a,o){var i="ims/dev/goods/".concat(r.HotelID,"/").concat(Date.now(),".").concat(t.split(".").pop());e.uploadFile({url:"https://up-z1.qiniup.com",filePath:t,name:"file",header:{"Content-Type":"multipart/form-data"},formData:{token:n,key:i},success:function(e){if(200===e.statusCode){var t=JSON.parse(e.data);r.form.Image="".concat(r.qiniuDomain,"/").concat(t.key),r.imageUrl="".concat(r.qiniuDomain,"/").concat(t.key),console.log(r.form.Image),a(t)}else o(new Error("上传失败"))},fail:function(e){o(e)}})}))},onCategoryChange:function(e){this.form.category=this.categories[e.detail.value]},submitForm:(0,s.throttle)((0,i.default)(o.default.mark((function t(){var n=this;return o.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.form.Name){t.next=3;break}return e.showToast({title:"请填写物品名称",icon:"none"}),t.abrupt("return");case 3:if(this.form.Uint){t.next=6;break}return e.showToast({title:"请填写单位",icon:"none"}),t.abrupt("return");case 6:return this.form.Price=Number(this.form.Price),this.form.MinStock=Number(this.form.MinStock),this.form.MaxStock=Number(this.form.MaxStock),this.form.ClassID=this.classList.find((function(e){return e.Name===n.selectedClass})).ID,t.next=12,(0,c.addGoodsItme)(this.form).then((function(t){t.ErrorMsg?e.showToast({title:t.ErrorMsg,icon:"none"}):(e.showToast({title:"提交成功",icon:"success"}),n.form={Name:"",Uint:"",Format:"",Price:"",ClassID:"",Suppliers:"",MinStock:"",MaxStock:"",Image:"",Note:""},n.imageUrl="")}));case 12:case"end":return t.stop()}}),t,this)}))),1e3),onClassChange:function(e){this.selectedClass=this.classList[e.detail.value].Name}},mounted:function(){this.getUserConfig(),this.getHotelClassList(),this.HotelID=e.getStorageSync("user_info").Hotel.ID}};t.default=l}).call(this,n(2)["default"],n(1)["default"])},90:function(e,t,n){"use strict";n.r(t);var r=n(91),a=n.n(r);for(var o in r)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(o);t["default"]=a.a},91:function(e,t,n){}},[[84,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/subpackageA/enter/index.js.map