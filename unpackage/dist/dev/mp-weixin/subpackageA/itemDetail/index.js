require('../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["subpackageA/itemDetail/index"],{222:function(t,e,n){"use strict";(function(t,e){var o=n(4);n(26);o(n(25));var i=o(n(223));t.__webpack_require_UNI_MP_PLUGIN__=n,e(i.default)}).call(this,n(1)["default"],n(2)["createPage"])},223:function(t,e,n){"use strict";n.r(e);var o=n(224),i=n(226);for(var a in i)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(a);n(228);var s,r=n(32),u=Object(r["default"])(i["default"],o["render"],o["staticRenderFns"],!1,null,"04c1142e",null,!1,o["components"],s);u.options.__file="subpackageA/itemDetail/index.vue",e["default"]=u.exports},224:function(t,e,n){"use strict";n.r(e);var o=n(225);n.d(e,"render",(function(){return o["render"]})),n.d(e,"staticRenderFns",(function(){return o["staticRenderFns"]})),n.d(e,"recyclableRender",(function(){return o["recyclableRender"]})),n.d(e,"components",(function(){return o["components"]}))},225:function(t,e,n){"use strict";var o;n.r(e),n.d(e,"render",(function(){return i})),n.d(e,"staticRenderFns",(function(){return s})),n.d(e,"recyclableRender",(function(){return a})),n.d(e,"components",(function(){return o}));try{o={imgPopup:function(){return Promise.all([n.e("common/vendor"),n.e("components/img-popup/img-popup")]).then(n.bind(null,384))},inoutPopup:function(){return Promise.all([n.e("common/vendor"),n.e("components/inout-popup/inout-popup")]).then(n.bind(null,452))},stockPopup:function(){return n.e("components/stock-popup/stock-popup").then(n.bind(null,459))}}}catch(r){if(-1===r.message.indexOf("Cannot find module")||-1===r.message.indexOf(".vue"))throw r;console.error(r.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var i=function(){var t=this,e=t.$createElement,n=(t._self._c,parseInt(t.form.ID)),o=parseInt(t.form.ID);t.$mp.data=Object.assign({},{$root:{m0:n,m1:o}})},a=!1,s=[];i._withStripped=!0},226:function(t,e,n){"use strict";n.r(e);var o=n(227),i=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);e["default"]=i.a},227:function(t,e,n){"use strict";(function(t,o){var i=n(4);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n(43)),s=i(n(45)),r=n(72),u=n(73),c=n(74),h=function(){Promise.all([n.e("common/vendor"),n.e("components/img-popup/img-popup")]).then(function(){return resolve(n(384))}.bind(null,n)).catch(n.oe)},l=function(){Promise.all([n.e("common/vendor"),n.e("components/inout-popup/inout-popup")]).then(function(){return resolve(n(452))}.bind(null,n)).catch(n.oe)},d=function(){n.e("components/stock-popup/stock-popup").then(function(){return resolve(n(459))}.bind(null,n)).catch(n.oe)},f=(getApp(),{data:function(){return{statusBarHeight:0,menuButtonWidth:0,showScan:!1,imgContent:"",title:"",imageUrl:"",screenWidth:"",buttonX:220,buttonY:380,showAdditionalButtons:!1,isButtonDisabled:!1,additionalButtons:[],headerTitle:"",GoodsId:null,WarehouseID:null,warehouseName:"",form:{Image:"",Name:"",Uint:"",Format:"",Price:"",Class:{Name:""},Suppliers:"1",minStock:"1",maxStock:"1",initialStock:"1",remark:"1",ID:""},list:{},imagePath:"",categories:["默认分类","分类1","分类2","分类3"],touchStartX:0,touchStartY:0,initialButtonX:220,initialButtonY:380,isDragging:!1}},components:{imgPopup:h,inoutPopup:l,stockPopup:d},onLoad:function(e){console.log(e,"option"),this.GoodsId=e.goosId,this.headerTitle=e.id,this.showScan=e.showScan,this.WarehouseID=e.warehouseId,console.log(this.WarehouseID,"WarehouseID");var n=t.getWindowInfo();this.statusBarHeight=n.statusBarHeight||0;var o=t.getMenuButtonBoundingClientRect();this.menuButtonWidth=o.width,this.navBarHeight=o.bottom+(o.top-this.statusBarHeight)},onReady:function(){t.setNavigationBarTitle({title:this.headerTitle})},methods:{handleBack:function(){setTimeout((function(){t.navigateTo({url:"/subpackageA/itemPage/index"})}),100)},handleTouchStart:function(t){this.touchStartX=t.touches[0].clientX,this.touchStartY=t.touches[0].clientY,this.initialButtonX=this.buttonX,this.initialButtonY=this.buttonY,this.isDragging=!1},handleTouchMove:function(e){var n=e.touches[0].clientX-this.touchStartX,o=e.touches[0].clientY-this.touchStartY;if((Math.abs(n)>5||Math.abs(o)>5)&&(this.isDragging=!0),this.isDragging){var i=t.getWindowInfo().windowWidth,a=t.getWindowInfo().windowHeight,s=60,r=this.initialButtonX+n,u=this.initialButtonY+o;r=Math.max(0,Math.min(i-s,r)),u=Math.max(0,Math.min(a-s,u)),this.buttonX=r,this.buttonY=u}},handleTouchEnd:function(){this.isDragging||this.toggleButtons()},updateItem:function(){console.log(this.form,"form"),t.navigateTo({url:"/subpackageA/enter/index?form="+encodeURIComponent(JSON.stringify(this.form))})},onCloseInout:function(){this.getGoodsItme()},closeSubButtons:function(){this.showAdditionalButtons=!1,this.isButtonDisabled=!0},delectItme:(0,u.throttle)((0,s.default)(a.default.mark((function e(){var n,o;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.form.CurrentStock){e.next=3;break}return t.showToast({title:"当前库存不为0，无法删除",icon:"none"}),e.abrupt("return");case 3:return e.prev=3,e.next=6,(0,r.showModalAsync)({content:"确定删除".concat(this.form.Name,"吗？")});case 6:if(n=e.sent,!n){e.next=12;break}return e.next=10,(0,c.deleteGoodsItme)({ID:this.form.ID});case 10:o=e.sent,o.ErrorMsg?t.showToast({title:o.ErrorMsg,icon:"none"}):t.showToast({title:"删除成功",icon:"success",duration:500,complete:function(){t.navigateTo({url:"/subpackageA/itemPage/index"})}});case 12:e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](3),t.showToast({title:"删除失败",icon:"none"});case 17:case"end":return e.stop()}}),e,this,[[3,14]])}))),1e3),getGoodsItme:function(){var e=this;return(0,s.default)(a.default.mark((function n(){return a.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,(0,c.getGoodsItme)({ID:e.GoodsId,WarehouseID:e.WarehouseID}).then((function(n){console.log(n,"res"),e.form=n.Data[0],e.headerTitle=n.Data[0].Name,e.warehouseName=n.Data[0].Warehouse.Name,t.setNavigationBarTitle({title:e.headerTitle})}));case 2:case"end":return n.stop()}}),n)})))()},onSave:function(){t.showToast({title:"执行保存操作",icon:"none"})},onImgClose:function(){console.log("弹窗已关闭")},clickQrCode:(0,u.throttle)((0,s.default)(a.default.mark((function e(){var n,o;return a.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n={WarehouseID:this.WarehouseID,GoodsID:this.form.ID},e.next=3,(0,c.getQrcode)(n);case 3:o=e.sent,o.ErrorMsg?t.showToast({title:o.ErrorMsg,icon:"none"}):(this.imageUrl=o.Data,this.imgContent=this.form.Name+" "+this.form.Format+"/"+this.form.Uint,this.warehouseName=this.form.Warehouse.Name,console.log(this.$refs.imagePopup,"this.$refs.imagePopup"),this.$refs.imagePopup.open());case 5:case"end":return e.stop()}}),e,this)}))),0),onMove:function(t){this.buttonX=t.detail.x,this.buttonY=t.detail.y},toggleButtons:function(e){if(e&&(e.stopPropagation(),e.preventDefault()),!e||e.target===e.currentTarget)if(console.log(111111),console.log(this.showAdditionalButtons),this.showAdditionalButtons)this.showAdditionalButtons=!1,this.isButtonDisabled=!1;else{var n=80,o=t.getWindowInfo().windowWidth,i=t.getWindowInfo().windowHeight;this.additionalButtons=[],this.additionalButtons=[{text:"明细",x:this.buttonX,y:Math.max(0,this.buttonY-n)},{text:"二维码",x:this.buttonX,y:Math.min(i-60,this.buttonY+n)},{text:"入库",x:Math.max(0,this.buttonX-n),y:this.buttonY},{text:"出库",x:Math.min(o-60,this.buttonX+n),y:this.buttonY}],this.showAdditionalButtons=!0,this.isButtonDisabled=!0}},handleButtonClick:function(e){if("明细"===e&&(console.log(this.form.ID,"this.form.ID"),t.navigateTo({url:"/subpackageA/inventoryDetails/index?id="+this.form.ID+"&warehouseId="+this.WarehouseID})),"盘点"===e&&(this.title=e,this.$refs.stockPopup.open()),"转入库"===e&&(this.title=e,this.$refs.imagePopup.open()),"二维码"===e&&this.clickQrCode(),"入库"===e){var n=t.getStorageSync("user_page")["fe:workbench"],o=n.find((function(t){return"入库"===t.Name}));o?(this.title=e,this.$refs.inoutPopup.open()):t.showToast({title:"暂无权限",icon:"error"})}if("出库"===e){var i=t.getStorageSync("user_page")["fe:workbench"],a=i.find((function(t){return"出库"===t.Name}));a?(this.title=e,this.$refs.inoutPopup.open()):t.showToast({title:"暂无权限"})}this.showAdditionalButtons=!1,this.isButtonDisabled=!1},onCategoryChange:function(t){this.form.category=this.categories[t.detail.value]},decodeAndShowImage:function(e){var n=this;return(0,s.default)(a.default.mark((function o(){var i;return a.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,i=n.getPureBase64(e),o.next=4,n.base64ToTempFilePath(i);case 4:n.imagePath=o.sent,console.log(n.imagePath,"this.imagePath"),o.next=12;break;case 8:o.prev=8,o.t0=o["catch"](0),t.showToast({title:"图片解码失败",icon:"none"}),console.error(o.t0);case 12:case"end":return o.stop()}}),o,null,[[0,8]])})))()},getPureBase64:function(t){return t.replace(/^data:image\/\w+;base64,/,"")},base64ToTempFilePath:function(t){return new Promise((function(e,n){var i=o.base64ToArrayBuffer(t),a="".concat(o.env.USER_DATA_PATH,"/temp_").concat(Date.now(),".png");o.getFileSystemManager().writeFile({filePath:a,data:i,encoding:"binary",success:function(){return e(a)},fail:function(t){return n(t)}})}))},decodeBase64:function(e){var n=e.replace(/^data:.+;base64,/,"");return t.base64ToArrayBuffer(n)}},mounted:function(){this.getGoodsItme()}});e.default=f}).call(this,n(2)["default"],n(1)["default"])},228:function(t,e,n){"use strict";n.r(e);var o=n(229),i=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(a);e["default"]=i.a},229:function(t,e,n){}},[[222,"common/runtime","common/vendor","subpackageA/common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/subpackageA/itemDetail/index.js.map