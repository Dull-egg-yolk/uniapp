{"version":3,"sources":["webpack:////Users/edy/Desktop/jiu/uniapp/components/login-popup/login-popup.vue?8b9b","webpack:////Users/edy/Desktop/jiu/uniapp/components/login-popup/login-popup.vue?983f","webpack:////Users/edy/Desktop/jiu/uniapp/components/login-popup/login-popup.vue?a4b8","webpack:////Users/edy/Desktop/jiu/uniapp/components/login-popup/login-popup.vue?26f2","uni-app:///components/login-popup/login-popup.vue","webpack:////Users/edy/Desktop/jiu/uniapp/components/login-popup/login-popup.vue?babe"],"names":["renderjs","component","options","__file","components","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped","props","zIndex","type","default","data","userInfo","avatarUrl","nickName","canSubmit","visible","popupContent","agreed","canLogin","qiniuDomain","uploadToken","watch","methods","getUserConfig","uni","title","icon","res","open","close","wx","handleConfirm","handleChooseAvatar","console","handleNicknameInput","uploadImage","url","filePath","name","header","formData","token","key","success","resolve","reject","fail","checkCanSubmit","mounted"],"mappings":"mIAAA,oIACIA,EADJ,QASIC,EAAY,qBACd,aACA,YACA,sBACA,EACA,KACA,WACA,MACA,EACA,gBACAD,GAGFC,EAAUC,QAAQC,OAAS,yCACZ,aAAAF,E,0CCvBf,uQ,iCCAA,IAAIG,EAAJ,0LACA,IAAIC,EAAS,WACX,IAAIC,EAAMC,KACNC,EAAKF,EAAIG,eACJH,EAAII,MAAMC,IAEjBC,GAAmB,EACnBC,EAAkB,GACtBR,EAAOS,eAAgB,G,iCCRvB,yHAAy1B,eAAG,G,uJCoE51B,Q,EACA,CACAC,OACAC,QACAC,YACAC,eAGAC,gBACA,OACAC,UACAC,aACAC,aAEAC,aACAC,WACAC,gBACAJ,aACAC,YACAI,UACAC,YACAC,kDACAC,iBAGAC,OACA,sCACA,sCAEAC,SACAC,yBAAA,qJACA,uCACA,WACAC,aACAC,iBACAC,cAGA,6BAEA,OATAC,OAAA,0CADA,IAYAC,gBAEAJ,eACA,iBAEAK,iBAEAL,eACA,gBACA,oBAEAM,gBAGAC,yBACA,sBACA,cAGAC,+BACAC,wBAEA,2CACA,4DAIAC,gCACA,uCAGAC,0BAAA,WACA,kCACA,+FACAX,cACAY,+BACAC,WACAC,YACAC,QACA,sCAEAC,UACAC,QACAC,OAEAC,oBACA,uBACA,yBACA,gEAEAV,sCACAW,UAEAC,sBAGAC,iBACAD,YAMAE,0BACA,mEACA,gBACAvB,6CAIAwB,mBACA,uBAEA,c,6ECvLA,yHAAglD,eAAG,G","file":"components/login-popup/login-popup.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./login-popup.vue?vue&type=template&id=79803dd4&scoped=true&\"\nvar renderjs\nimport script from \"./login-popup.vue?vue&type=script&lang=js&\"\nexport * from \"./login-popup.vue?vue&type=script&lang=js&\"\nimport style0 from \"./login-popup.vue?vue&type=style&index=0&id=79803dd4&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"79803dd4\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/login-popup/login-popup.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login-popup.vue?vue&type=template&id=79803dd4&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login-popup.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login-popup.vue?vue&type=script&lang=js&\"","<template>\n  <div>\n   <!-- 遮罩层（置灰禁用页面） -->\n   <view \n     class=\"popup-mask\" \n     v-if=\"visible\" \n     @tap.stop=\"close\"\n     :style=\"{ zIndex: zIndex - 1 }\"\n   />\n   <!-- 弹窗主体 -->\n   <div \n     class=\"popup-container\"\n     :class=\"{ 'popup-show': visible }\"\n     :style=\"{ zIndex: zIndex }\"\n   >\n     <!-- 标题栏 -->\n     <view class=\"popup-header\">\n       <text class=\"popup-title-top\">九点荟会员管理系统 <text class=\"span\">申请</text></text>\n       <text class=\"popup-title-center\">获取你的头像、昵称</text>\n       <text class=\"popup-title-bom\">展示个人信息</text>\n     </view>\n\n     <!-- 内容区域（可滚动） -->\n     <view class=\"popup-content\">\n      <!-- 头像选择 -->\n      <view class=\"avatar-section\">\n        <text class=\"section-label\">头像</text>\n        <button \n          class=\"avatar-btn\" \n          open-type=\"chooseAvatar\" \n          @chooseavatar=\"handleChooseAvatar\"\n        >\n          <image \n            class=\"avatar-img\" \n            :src=\"userInfo.avatarUrl || '/static/img/header-img.svg'\" \n            mode=\"aspectFill\"\n          />\n        </button>\n      </view>\n\n      <!-- 昵称输入 -->\n      <view class=\"nickname-section\">\n        <text class=\"section-label\">昵称</text>\n        <input\n          class=\"nickname-input\"\n          type=\"nickname\"\n          v-model=\"userInfo.nickName\"\n          placeholder=\"请输入昵称\"\n          @input=\"handleNicknameInput\"\n        />\n      </view>\n     </view>\n\n     <!-- 底部按钮 -->\n     <view class=\"popup-footer\">\n       <button \n          class=\"save-btn\" \n          :disabled=\"!canSubmit\" \n           @tap.stop=\"handleConfirm\"\n        >\n          立即登录\n        </button>\n     </view>\n   </div> \n </div>\n</template>\n\n<script>\nimport { getUserConfig } from \"@/api/user\";\nexport default {\n props: {\n   zIndex: {\n     type: Number,\n     default: 9999 // 必须高于TabBar的z-index（通常为999）\n   }\n },\n data() {\n   return {\n    userInfo: {\n      avatarUrl: '',\n      nickName: ''\n    },\n    canSubmit: false,\n     visible: false,\n     popupContent: '',\n     avatarUrl: '', // 用户头像URL\n     nickName: '',  // 用户昵称\n     agreed: false, // 是否同意协议\n     canLogin: false, // 是否可以登录\n     qiniuDomain: 'https://staticweb.jiudianhui.com.cn', // 七牛域名\n     uploadToken: '', // 七牛上传token\n   }\n },\n watch: {\n    'userInfo.avatarUrl': 'checkCanSubmit',\n    'userInfo.nickName': 'checkCanSubmit'\n  },\n methods: {\n  async getUserConfig(){\n      const res = await getUserConfig().then(res=>{\n        if (res.ErrorMsg) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: res.ErrorMsg,\n\t\t\t\t\t\ticon: \"none\"\n\t\t\t\t\t});\n        } else {\n          this.uploadToken = res.Data.CdnT; \n        }\n      })\n    },\n   open() {\n     // 隐藏TabBar（小程序专用）\n     uni.hideTabBar()\n     this.visible = true\n   },\n   close() {\n     // 显示TabBar（小程序专用\n     uni.showTabBar()\n     this.visible = false\n     this.$emit('close')\n     // #ifdef MP-WEIXIN\n     wx.hideTabBar();\n     // #endif\n   },\n   handleConfirm() {\n     this.$emit('confirm')\n     this.close()\n   },\n    // 选择头像回调\n    handleChooseAvatar(e) {\n      console.log(e, '选择头像回调');\n      \n      this.userInfo.avatarUrl = e.detail.avatarUrl\n      this.uploadImage(this.userInfo.avatarUrl, this.uploadToken);\n    },\n    \n    // 昵称输入回调\n    handleNicknameInput(e) {\n      this.userInfo.nickName = e.detail.value\n    },\n    // 上传图片到七牛\n    uploadImage(filePath, token) {\n      return new Promise((resolve, reject) => {\n          const fileName = `ims/dev/goods/${this.HotelID}/${Date.now()}.${filePath.split('.').pop()}`;\n          uni.uploadFile({\n            url: 'https://up-z1.qiniup.com', // 根据区域修改s\n            filePath: filePath,\n            name: 'file',\n            header: {\n              'Content-Type': 'multipart/form-data' // 确保设置正确的Content-Type\n            },\n            formData: {\n              token: token,\n              key: fileName // 生成唯一文件名\n            },\n            success: (res) => {\n              if (res.statusCode === 200) {\n                const data = JSON.parse(res.data)\n                this.userInfo.avatarUrl = `${this.qiniuDomain}/${data.key}`\n                // this.imageUrl = `${this.qiniuDomain}/${data.key}`\n                console.log(this.userInfo.avatarUrl, '0');\n                resolve(data)\n              } else {\n                reject(new Error('上传失败'))\n              }\n            },\n            fail: (err) => {\n              reject(err)\n            }\n          })\n        })\n    },\n    // 检查是否可以提交\n    checkCanSubmit() {\n      this.canSubmit = !!this.userInfo.avatarUrl && !!this.userInfo.nickName\n      if(this.canSubmit) {\n        uni.setStorageSync('userInfo', this.userInfo);\n      }\n    },\n },\n mounted(){\n    this.getUserConfig()\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n/* 遮罩层（置灰禁用） */\n.popup-mask {\n position: fixed;\n top: 0;\n left: 0;\n right: 0;\n bottom: 0;\n background: rgba(0, 0, 0, 0.6);\n backdrop-filter: blur(2px);\n z-index: 1;\n}\n\n/* 弹窗容器 */\n.popup-container {\n position: fixed;\n left: 0;\n right: 0;\n bottom: -100%;\n background: #fff;\n border-radius: 24rpx 24rpx 0 0;\n transition: all 0.3s ease;\n max-height: 70vh;\n display: flex;\n flex-direction: column;\n padding-bottom: calc(20rpx + env(safe-area-inset-bottom));\n z-index: 99999;\n}\n\n.popup-show {\n bottom: 0;\n}\n\n/* 标题栏 */\n.popup-header {\n padding: 28rpx 32rpx;\n display: flex;\n flex-direction: column;\n border-bottom: 1rpx solid #f5f5f5;\n position: relative;\n}\n.popup-title-top {\n  font-size: 26rpx;\n  color: #000;\n  margin-bottom: 40rpx;\n}\n.popup-title-top .span {\n  font-size: 24rpx;\n  color: #444544;\n  padding-left: 20rpx;\n}\n.popup-title-bom {\n  font-size: 22rpx;\n  color: #444544;\n  margin-top: 20rpx;\n}\n.popup-title-center {\n  font-size: 28rpx;\n  font-weight: bold;\n  color: #000;\n}\n.popup-title {\n font-size: 34rpx;\n font-weight: bold;\n color: #333;\n}\n\n.close-btn {\n width: 40rpx;\n height: 40rpx;\n display: flex;\n align-items: center;\n justify-content: center;\n}\n\n.close-icon {\n font-size: 40rpx;\n color: #999;\n line-height: 1;\n}\n\n/* 内容区域 */\n.popup-content {\n flex: 1;\n padding: 32rpx;\n font-size: 30rpx;\n color: #666;\n line-height: 1.6;\n}\n\n/* 底部按钮 */\n.popup-footer {\n padding: 24rpx 32rpx;\n border-top: 1rpx solid #f5f5f5;\n}\n\n.confirm-btn {\n background: #07C160;\n color: #fff;\n border-radius: 48rpx;\n height: 88rpx;\n line-height: 88rpx;\n font-size: 32rpx;\n font-weight: 500;\n}\n.avatar-section, .nickname-section {\n  display: flex;\n  align-items: center;\n  padding: 30rpx 0;\n  border-bottom: 1rpx solid #eee;\n  .section-label {\n    width: 120rpx;\n    font-size: 32rpx;\n  }\n}\n\n.avatar-btn {\n  padding: 0;\n  margin: 0;\n  background: none;\n  border: none;\n  line-height: 1;\n  &::after {\n    border: none;\n  }\n}\n\n.avatar-img {\n  width: 100rpx;\n  height: 100rpx;\n  border-radius: 50%;\n  border: 1rpx solid #f0f0f0;\n}\n\n.nickname-input {\n  flex: 1;\n  font-size: 32rpx;\n  height: 100%;\n}\n</style>","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login-popup.vue?vue&type=style&index=0&id=79803dd4&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login-popup.vue?vue&type=style&index=0&id=79803dd4&lang=scss&scoped=true&\""],"sourceRoot":""}